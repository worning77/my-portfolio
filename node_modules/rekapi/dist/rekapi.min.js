/*! rekapi - v1.7.4 - 2017-01-02 - http://rekapi.com */
!function(a){function b(a,b,c,d){c.each(a._events[b],function(b){b(a,d)})}function c(a){a._animationLengthValid=!1}function d(){}var e=[],f=function(d,e,f){"use strict";function g(a,b){var c=a.getAnimationLength();if(0===c)return b;var d=Math.floor(b/c);return d}function h(a){return t()-a._loopTimestamp}function i(a,b){return b>=a._timesToIterate&&-1!==a._timesToIterate}function j(a,c){i(a,c)&&(a.stop(),b(a,"animationComplete",e))}function k(a,b,c){var d,e=a.getAnimationLength();return 0===e?0:d=i(a,c)?e:b%e}function l(a,c){var d=0,f=0;f=g(a,c),d=k(a,c,f),a._loopPosition=d;var h=[];if(f>a._latestIteration){b(a,"animationLooped",e);var i={name:"function"};e.each(a._actors,function(a){var b=e.where(a._keyframeProperties,i),c=e.last(b);c&&!c.hasFired&&c.invoke(),h=h.concat(b)})}a._latestIteration=f,a.update(d,!0),j(a,f),e.each(h,function(a){a.hasFired=!1})}function m(a){l(a,h(a))}function n(b){b._scheduleUpdate.call?b._loopId=b._scheduleUpdate.call(a,b._updateFn,s):b._loopId=setTimeout(b._updateFn,s)}function o(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||a.mozCancelRequestAnimationFrame&&a.mozRequestAnimationFrame||a.setTimeout}function p(){return a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.oCancelAnimationFrame||a.msCancelAnimationFrame||a.mozCancelRequestAnimationFrame||a.clearTimeout}function q(b){b._cancelUpdate.call?b._cancelUpdate.call(a,b._loopId):clearTimeout(b._loopId)}function r(a){return this.context=a||{},this._actors={},this._playState=u.STOPPED,this._events={animationComplete:[],playStateChange:[],play:[],pause:[],stop:[],beforeUpdate:[],afterUpdate:[],addActor:[],removeActor:[],beforeAddKeyframeProperty:[],addKeyframeProperty:[],removeKeyframeProperty:[],removeKeyframePropertyComplete:[],beforeRemoveKeyframeProperty:[],addKeyframePropertyTrack:[],removeKeyframePropertyTrack:[],timelineModified:[],animationLooped:[]},this._timesToIterate=-1,this._animationLength=0,this._animationLengthValid=!1,this._loopId=null,this._loopTimestamp=null,this._pausedAtTime=null,this._lastUpdatedMillisecond=0,this._latestIteration=0,this._loopPosition=null,this._scheduleUpdate=o(),this._cancelUpdate=p(),this._updateFn=e.bind(function(){n(this),m(this)},this),e.each(r._rendererInitHook,function(a){a(this)},this),this}var s=1e3/60,t=f.now,u={STOPPED:"stopped",PAUSED:"paused",PLAYING:"playing"};r.Tweenable=f,r._=e,r._rendererInitHook={},r.prototype.addActor=function(a){var d;return d=a instanceof r.Actor?a:new r.Actor(a),e.contains(this._actors,d)||("undefined"==typeof d.context&&(d.context=this.context),d.rekapi=this,this._actors[d.id]=d,c(this),d.setup(),b(this,"addActor",e,d)),d},r.prototype.getActor=function(a){return this._actors[a]},r.prototype.getActorIds=function(){return e.pluck(this._actors,"id")},r.prototype.getAllActors=function(){return e.clone(this._actors)},r.prototype.getActorCount=function(){return e.size(this._actors)},r.prototype.removeActor=function(a){return delete this._actors[a.id],delete a.rekapi,a.teardown(),c(this),b(this,"removeActor",e,a),a},r.prototype.removeAllActors=function(){return e.map(this.getAllActors(),this.removeActor,this)},r.prototype.play=function(a){return q(this),this._playState===u.PAUSED?this._loopTimestamp+=t()-this._pausedAtTime:this._loopTimestamp=t(),this._timesToIterate=a||-1,this._playState=u.PLAYING,n(this),b(this,"playStateChange",e),b(this,"play",e),this},r.prototype.playFrom=function(a,b){return this.play(b),this._loopTimestamp=t()-a,e.invoke(this._actors,"_resetFnKeyframesFromMillisecond",a),this},r.prototype.playFromCurrent=function(a){return this.playFrom(this._lastUpdatedMillisecond,a)},r.prototype.pause=function(){return this._playState===u.PAUSED?this:(this._playState=u.PAUSED,q(this),this._pausedAtTime=t(),b(this,"playStateChange",e),b(this,"pause",e),this)},r.prototype.stop=function(){return this._playState=u.STOPPED,q(this),e.each(this._actors,function(a){a.stop()._resetFnKeyframesFromMillisecond(0)}),b(this,"playStateChange",e),b(this,"stop",e),this},r.prototype.isPlaying=function(){return this._playState===u.PLAYING},r.prototype.isPaused=function(){return this._playState===u.PAUSED},r.prototype.isStopped=function(){return this._playState===u.STOPPED},r.prototype.update=function(a,c){var d=this.renderer&&this.renderer._batchRendering;return void 0===a&&(a=this._lastUpdatedMillisecond),b(this,"beforeUpdate",e),e.each(this._actors,function(b){b._updateState(a,c),!d&&b.wasActive&&"function"==typeof b.render&&b.render(b.context,b.get())}),this._lastUpdatedMillisecond=a,b(this,"afterUpdate",e),this},r.prototype.getLastPositionUpdated=function(){return this._lastUpdatedMillisecond/this.getAnimationLength()},r.prototype.getLastMillisecondUpdated=function(){return this._lastUpdatedMillisecond},r.prototype.getAnimationLength=function(){if(!this._animationLengthValid){var a=[];e.each(this._actors,function(b){a.push(b.getEnd())}),this._animationLength=Math.max.apply(Math,a),this._animationLengthValid=!0}return this._animationLength},r.prototype.on=function(a,b){return this._events[a]?(this._events[a].push(b),this):void 0},r.prototype.trigger=function(a,c){return b(this,a,e,c),this},r.prototype.off=function(a,b){return this._events[a]?(b?this._events[a]=e.without(this._events[a],b):this._events[a]=[],this):void 0},r.prototype.exportTimeline=function(){var a={duration:this.getAnimationLength(),actors:[]};e.each(this._actors,function(b){a.actors.push(b.exportTimeline())},this);var b={};return e.chain(f.prototype.formula).filter(function(a){return"number"==typeof a.x1}).each(function(a){b[a.displayName]=e.pick(a,"displayName","x1","y1","x2","y2")}).value(),a.curves=b,a},r.prototype.importTimeline=function(a){e.each(a.curves,function(a,b){f.setBezierFunction(b,a.x1,a.y1,a.x2,a.y2)}),e.each(a.actors,function(a){var b=new r.Actor;b.importTimeline(a),this.addActor(b)},this)},r.prototype.getEventNames=function(){return e.keys(this._events)},r.nonCustomFormulaNames=e.keys(f.prototype.formula),r.util={},d.Rekapi=r};e.push(function(a){"use strict";function e(a){return a.millisecond}function f(a){return a._millisecond}function g(a,c,d){a.rekapi&&b(a.rekapi,c,t,d)}function h(a,b){var c=a._timelinePropertyCache,d=t.sortedIndex(c,{_millisecond:b},f);return c[d]&&c[d]._millisecond===b?c[d]:d>=1?c[d-1]:c[0]}function i(a,b){var c={};return t.each(a._propertyTracks,function(a,d){var e=j(a,b);a[e]&&a[e].millisecond===b?c[d]=a[e]:e>=1?c[d]=a[e-1]:c[d]=a[0]}),c}function j(a,b){return t.sortedIndex(a,{millisecond:b},e)}function k(a,b){var c=j(a,b);return a[c]&&a[c].millisecond===b?c:void 0}function l(a){a._timelinePropertyCacheValid=!1}function m(a){if(!a._timelinePropertyCacheValid){a._timelinePropertyCache=[],a._timelineFunctionCache=[];var b=a._timelinePropertyCache,c=t.values(a._keyframeProperties);c.sort(function(a,b){return a.millisecond-b.millisecond});var d=i(a,0);d._millisecond=0,b.push(d),t.each(c,function(c){c.millisecond!==d._millisecond&&(d=t.clone(d),d._millisecond=c.millisecond,b.push(d)),d[c.name]=c,"function"===c.name&&a._timelineFunctionCache.push(c)}),a._timelinePropertyCacheValid=!0}}function n(a){var b=[],c=a._propertyTracks;t.each(c,function(a,c){a.length||b.push(c)}),t.each(b,function(b){delete c[b],g(a,"removeKeyframePropertyTrack",b)})}function o(a){t.each(a._propertyTracks,function(b,c){a._propertyTracks[c]=t.sortBy(b,"millisecond"),b=a._propertyTracks[c],t.each(b,function(a,c){a.linkToNext(b[c+1])})})}function p(a){o(a),l(a),a.rekapi&&c(a.rekapi),g(a,"timelineModified")}var q="linear",r=a.Rekapi,s=r.Tweenable,t=r._;r.Actor=function(a){return a=a||{},s.call(this),t.extend(this,{_propertyTracks:{},_timelinePropertyCache:[],_timelineFunctionCache:[],_timelinePropertyCacheValid:!1,_keyframeProperties:{},id:t.uniqueId(),context:a.context,setup:a.setup||d,render:a.render||d,teardown:a.teardown||d,data:{},wasActive:!0}),this};var u=r.Actor,v=function(){};v.prototype=s.prototype,u.prototype=new v,u.prototype.keyframe=function(a,b,d){b instanceof Function&&(b={"function":b}),d=d||q;var e,f=s.composeEasingObject(b,d);return t.each(b,function(b,c){e=new r.KeyframeProperty(a,c,b,f[c]),this.addKeyframeProperty(e)},this),this.rekapi&&c(this.rekapi),l(this),g(this,"timelineModified"),this},u.prototype.hasKeyframeAt=function(a,b){var c=this._propertyTracks;if(b){if(!t.has(c,b))return!1;c=t.pick(c,b)}var d;for(d in c)if(c.hasOwnProperty(d)&&this.getKeyframeProperty(d,a))return!0;return!1},u.prototype.copyKeyframe=function(a,b){var c={},d={};return t.each(this._propertyTracks,function(a,e){var f=this.getKeyframeProperty(e,b);f&&(c[e]=f.value,d[e]=f.easing)},this),this.keyframe(a,c,d),this},u.prototype.moveKeyframe=function(a,b){return!this.hasKeyframeAt(a)||this.hasKeyframeAt(b)?!1:(t.each(this._propertyTracks,function(c,d){var e=k(c,a);if("undefined"!=typeof e){var f=c[e];f.millisecond=b}},this),p(this),!0)},u.prototype.modifyKeyframe=function(a,b,c){return c=c||{},t.each(this._propertyTracks,function(d,e){var f=this.getKeyframeProperty(e,a);f?f.modifyWith({value:b[e],easing:c[e]}):"undefined"!=typeof b[e]&&(f=new r.KeyframeProperty(a,e,b[e],c[e]),this.addKeyframeProperty(f))},this),p(this),this},u.prototype.removeKeyframe=function(a){this._propertyTracks;return t.each(this._propertyTracks,function(b,c){var d=k(b,a);if("undefined"!=typeof d){var e=b[d];this._deleteKeyframePropertyAt(b,d),e.detach()}},this),n(this),p(this),g(this,"timelineModified"),this},u.prototype.removeAllKeyframes=function(){return t.each(this._propertyTracks,function(a){a.length=0}),t.each(this._keyframeProperties,function(a){a.detach()},this),n(this),this._keyframeProperties={},this.removeKeyframe(0)},u.prototype.getKeyframeProperty=function(a,b){var c=this._propertyTracks[a],d=k(c,b);return"undefined"!=typeof d?c[d]:void 0},u.prototype.modifyKeyframeProperty=function(a,b,c){var d=this.getKeyframeProperty(a,b);if(d){if("millisecond"in c&&this.hasKeyframeAt(c.millisecond,a))throw new Error("Tried to move "+a+" to "+c.millisecond+"ms, but a keyframe property already exists there");d.modifyWith(c),p(this)}return this},u.prototype.removeKeyframeProperty=function(a,c){var d=this._propertyTracks;if("undefined"!=typeof d[a]){var e=d[a],f=k(e,c),g=e[f];return b(this.rekapi,"beforeRemoveKeyframeProperty",t,g),this._deleteKeyframePropertyAt(e,f),g.detach(),n(this),p(this),b(this.rekapi,"removeKeyframePropertyComplete",t,g),g}},u.prototype.getTrackNames=function(){return t.keys(this._propertyTracks)},u.prototype.getPropertiesInTrack=function(a){var b=this._propertyTracks[a];return b?b.slice(0):void 0},u.prototype.getStart=function(a){var b=[],c=this._propertyTracks;if(c.hasOwnProperty(a)){var d=c[a][0];d&&b.push(d.millisecond)}else t.each(c,function(a){a.length&&b.push(a[0].millisecond)});0===b.length&&(b=[0]);var e;return e=b.length>0?Math.min.apply(Math,b):0},u.prototype.getEnd=function(a){var b=0,c=this._propertyTracks;return a&&(c={},c[a]=this._propertyTracks[a]),t.each(c,function(a){if(a.length){var c=Math.max.apply(Math,t.map(a,"millisecond"));c>b&&(b=c)}},this),b},u.prototype.getLength=function(a){return this.getEnd(a)-this.getStart(a)},u.prototype.wait=function(a){var b=this.getEnd();if(b>=a)return this;var c=this.getEnd(),d=i(this,this.getEnd()),e={},f={};return t.each(d,function(a,b){e[b]=a.value,f[b]=a.easing}),this.modifyKeyframe(c,e,f),this.keyframe(a,e,f),this},u.prototype._insertKeyframePropertyAt=function(a,b,c){b.splice(c,0,a)},u.prototype._deleteKeyframePropertyAt=function(a,b){a.splice(b,1)},u.prototype.addKeyframeProperty=function(a){this.rekapi&&b(this.rekapi,"beforeAddKeyframeProperty",t,a),a.actor=this,this._keyframeProperties[a.id]=a;var c=a.name,d=this._propertyTracks;if("undefined"==typeof this._propertyTracks[c])d[c]=[a],this.rekapi&&b(this.rekapi,"addKeyframePropertyTrack",t,a);else{var e=j(d[c],a.millisecond);if(d[c][e]){var f=a.millisecond,g=d[c][e].millisecond;if(g===f)throw new Error("Tried to add a duplicate keyframe property, "+c+" @ "+f+" ms");this.rekapi&&this.rekapi._warnOnOutOfOrderKeyframes&&console.warn(new Error("Added a keyframe property before end of track, "+c+" @ "+f+" ms < "+g+" ms"))}this._insertKeyframePropertyAt(a,d[c],e),p(this)}return this.rekapi&&b(this.rekapi,"addKeyframeProperty",t,a),this},u.prototype.setActive=function(a,b){var c=this._propertyTracks._active&&this.getKeyframeProperty("_active",a);return c?c.value=b:(c=new r.KeyframeProperty(a,"_active",b),this.addKeyframeProperty(c)),this},u.prototype._updateState=function(a,b){var c=this.getStart(),e=this.getEnd(),f={};a=Math.min(e,a),m(this);var g=h(this,a);if(g._active&&a>=g._active.millisecond){if(this.wasActive=g._active.getValueAt(a),!this.wasActive)return this}else this.wasActive=!0;return c===e?t.each(g,function(b,c){if("_millisecond"!==c){if(b.shouldInvokeForMillisecond(a))return b.invoke(),void(b.hasFired=!1);f[c]=b.value}},this):t.each(g,function(b,c){if("_millisecond"!==c){if(this._beforeKeyframePropertyInterpolate!==d&&this._beforeKeyframePropertyInterpolate(b),b.shouldInvokeForMillisecond(a))return void b.invoke();f[c]=b.getValueAt(a),this._afterKeyframePropertyInterpolate!==d&&this._afterKeyframePropertyInterpolate(b,f)}},this),this.set(f),b||this._resetFnKeyframesFromMillisecond(a),this},u.prototype._resetFnKeyframesFromMillisecond=function(a){for(var b=this._timelineFunctionCache,c=t.sortedIndex(b,{millisecond:a},e),d=b.length;d>c;)b[c++].hasFired=!1},u.prototype._beforeKeyframePropertyInterpolate=d,u.prototype._afterKeyframePropertyInterpolate=d,u.prototype.exportTimeline=function(){var a={start:this.getStart(),end:this.getEnd(),trackNames:this.getTrackNames(),propertyTracks:{}};return t.each(this._propertyTracks,function(b,c){var d=a.propertyTracks[c]=[];t.each(b,function(a){d.push(a.exportPropertyData())})}),a},u.prototype.importTimeline=function(a){t.each(a.propertyTracks,function(a){t.each(a,function(a){var b={};b[a.name]=a.value,this.keyframe(a.millisecond,b,a.easing)},this)},this)}}),e.push(function(a){"use strict";var c="linear",d=a.Rekapi,e=d.Tweenable,f=d._,g=e.interpolate;d.KeyframeProperty=function(a,b,d,e){return this.id=f.uniqueId("keyframeProperty_"),this.millisecond=a,this.name=b,this.value=d,this.hasFired=null,this.easing=e||c,this.nextProperty=null,this};var h=d.KeyframeProperty;h.prototype.modifyWith=function(a){var b={};f.each(["millisecond","easing","value"],function(c){b[c]="undefined"==typeof a[c]?this[c]:a[c]},this),f.extend(this,b)},h.prototype.getValueAt=function(a){var b,c={},d={},e=this.nextProperty,f=Math.max(a,this.millisecond);if("boolean"==typeof this.value)b=this.value;else if(e){f=Math.min(f,e.millisecond),c[this.name]=this.value,d[this.name]=e.value;var h=e.millisecond-this.millisecond,i=(f-this.millisecond)/h;b=g(c,d,i,e.easing)[this.name]}else b=this.value;return b},h.prototype.linkToNext=function(a){this.nextProperty=a||null},h.prototype.detach=function(){var a=this.actor;return a&&a.rekapi&&(b(a.rekapi,"removeKeyframeProperty",f,this),delete a._keyframeProperties[this.id],this.actor=null),this},h.prototype.exportPropertyData=function(){return{millisecond:this.millisecond,name:this.name,value:this.value,easing:this.easing}},h.prototype.shouldInvokeForMillisecond=function(a){return a>=this.millisecond&&"function"===this.name&&!this.hasFired},h.prototype.invoke=function(){var a=this.actor.rekapi._loopPosition-this.millisecond,b=this.value.call(this.actor,a);return this.hasFired=!0,b}}),e.push(function(a){"use strict";function c(a,b,c){return"undefined"!=typeof c&&(a[b]=c,a.style[b]=c+"px"),a[b]}function d(a){a.clear()}function e(a,c){b(a,"beforeRender",i);var d,e=c._renderOrderSorter,f=c._renderOrder.length;if(e){var g=i.sortBy(c._canvasActors,e);d=i.pluck(g,"id")}else d=c._renderOrder;var h,j,k=c._canvasActors;for(j=0;f>j;j++)h=k[d[j]],h.wasActive&&h.render(h.context,h.get());return b(a,"afterRender",i),a}function f(a,b){b._renderOrder.push(a.id),b._canvasActors[a.id]=a}function g(a,b){b._renderOrder=i.without(b._renderOrder,a.id),delete b._canvasActors[a.id]}var h=a.Rekapi,i=h._;h._rendererInitHook.canvas=function(a){"undefined"!=typeof CanvasRenderingContext2D&&a.context instanceof CanvasRenderingContext2D&&(a.renderer=new j(a))},h.CanvasRenderer=function(a,b){this.rekapi=a,this.canvasContext=b||a.context,this._renderOrder=[],this._renderOrderSorter=null,this._canvasActors={},this._batchRendering=!0,i.extend(a._events,{beforeRender:[],afterRender:[]});var c=this;return a.on("afterUpdate",function(){e(a,c)}),a.on("addActor",function(a,b){f(b,c)}),a.on("removeActor",function(a,b){g(b,c)}),a.on("beforeRender",function(){d(c)}),this};var j=h.CanvasRenderer;j.prototype.height=function(a){return c(this.canvasContext.canvas,"height",a)},j.prototype.width=function(a){return c(this.canvasContext.canvas,"width",a)},j.prototype.clear=function(){return this.canvasContext.clearRect(0,0,this.width(),this.height()),this.rekapi},j.prototype.moveActorToLayer=function(a,b){return b<this._renderOrder.length&&b>-1&&(this._renderOrder=i.without(this._renderOrder,a.id),this._renderOrder.splice(b,0,a.id)),a},j.prototype.setOrderFunction=function(a){return this._renderOrderSorter=a,this.rekapi},j.prototype.unsetOrderFunction=function(){return this._renderOrderSorter=null,this.rekapi}}),e.push(function(a){"use strict";function c(a){return a%1===0}function d(){var a=document.body.style;return"-webkit-animation"in a?"webkit":"-moz-animation"in a?"mozilla":"-ms-animation"in a?"microsoft":"-o-animation"in a?"opera":"animation"in a?"w3":""}function e(a,b){var c=document.createElement("style"),d="rekapi-"+W++;return c.id=d,c.innerHTML=b,document.head.appendChild(c),f(a),c}function f(a){var b=document.createElement("div");Q.each(a.getAllActors(),function(a){if(1===a.context.nodeType){var c=a.context,d=c.parentElement;d.replaceChild(b,c),d.replaceChild(c,b)}}),b=null}function g(a,b,c){a.style[b]=c}function h(a){return Q.contains(T,a)}function i(a,b){var c=[];return Q.each(a,function(a){"undefined"!=typeof b[a]&&c.push(a+"("+b[a]+")")}),c.join(" ")}function j(a,b){Q.each(S,function(c){g(a,c,b)})}function k(a,b){var c=b.context;if(1===c.nodeType){var d=X.getActorClassName(b);c.className.match(d)||(c.className+=" "+d),b._transformOrder=T.slice(0),b._beforeKeyframePropertyInterpolate=l,b._afterKeyframePropertyInterpolate=m,b.render=Q.bind(n,b,b),b.teardown=Q.bind(o,b,b)}}function l(a){if("transform"===a.name){var b=a.value,c=a.nextProperty;c&&b.match(/3d\(/g)&&(a.value=b.replace(/3d\(/g,"__THREED__"),c.value=c.value.replace(/3d\(/g,"__THREED__"))}}function m(a,b){if("transform"===a.name){var c=a.value,d=a.nextProperty;if(d&&c.match(/__THREED__/g)){a.value=c.replace(/__THREED__/g,"3d("),d.value=d.value.replace(/__THREED__/g,"3d(");var e=a.name;b[e]=b[e].replace(/__THREED__/g,"3d(")}}}function n(a,b,c){var d=Q.keys(c),e=Q.filter(d,h),f=Q.reject(d,h),k=Q.pick(c,f);if(e.length){var l=Q.pick(c,e),m=i(a._transformOrder,l);j(b,m)}else c.transform&&j(b,c.transform);Q.each(k,function(a,c){g(b,c,a)})}function o(a){var b=a.context,c=b.className.match(/\S+/g),d=Q.without(c,X.getActorClassName(a));b.className=d.join(" ")}function p(a,b){b=b||{};var c,d=[];c=b.name?a.rekapi.getActorCount()>1?b.name+"-"+a.id:b.name:X.getActorClassName(a);var e=b.fps||Y,f=Math.ceil(a.rekapi.getAnimationLength()/1e3*e),g=!E(a),h=t(a,c,g,b.vendors,b.iterations,b.isCentered),i=q(a,c,f,g,b.vendors);return d.push(h),d.push(i),d.join("\n")}function q(a,b,c,d,e){var f=a.getTrackNames(),g=[];d?g.push(H(a,c)):Q.each(f,function(b){g.push(G(a,c,b))});var h=[];return d?h.push(r(g[0],b,e)):Q.each(f,function(a,c){h.push(r(g[c],b+"-"+a,e))}),h=h.join("\n")}function r(a,b,c){c=c||["w3"];var d=[];return Q.each(c,function(c){var e=V(ba,[_[c],b,a]),f=s(e,c);d.push(f)}),d.join("\n")}function s(a,b){var c=new RegExp(Z,"g"),d=_[b]+"transform",e=new RegExp($,"g"),f=_[b],g=a.replace(e,f).replace(c,d);return g}function t(a,b,c,d,e,f){d=d||["w3"];var g,h=[];Q.each(d,function(d){g=u(a,b,d,c,e,f),h.push(g)});var i=V(ca,[b,h.join("\n")]);return i}function u(a,b,c,d,e,f){var g=[],h=_[c];return g.push(v(a,b,h,d)),g.push(w(a,h)),g.push(x(a,h)),g.push(y(h)),g.push(z(h)),g.push(A(a.rekapi,h,e)),f&&g.push(B(h)),g.join("\n")}function v(a,b,c,d){var e=V("  %sanimation-name:",[c]);if(d)e+=V(" %s-keyframes;",[b]);else{var f,g=a.getTrackNames(),h=Q.intersection(g,T),i=Q.difference(g,T);h.length?(f=i,f.push("transform")):f=g,Q.each(f,function(a){e+=V(" %s-%s-keyframes,",[b,a])}),e=e.slice(0,e.length-1),e+=";"}return e}function w(a,b){return V("  %sanimation-duration: %sms;",[b,a.getEnd()-a.getStart()])}function x(a,b){return V("  %sanimation-delay: %sms;",[b,a.getStart()])}function y(a){return V("  %sanimation-fill-mode: forwards;",[a])}function z(a){return V("  %sanimation-timing-function: linear;",[a])}function A(a,b,c){var d;d=c?c:-1===a._timesToIterate?"infinite":a._timesToIterate;var e="  %sanimation-iteration-count: %s;";return V(e,[b,d])}function B(a){return V("  %stransform-origin: 0 0;",[a])}function C(a){var b=!1,c=a.nextProperty;if(c){if(D(a,c))return!0;var d,e=c.easing.split(" "),f=0,g=e.length,h=e[0];for(f;g>f;f++){if(d=e[f],!aa[d]||h!==d){b=!1;break}b=!0,h=d}}return b}function D(a,b){return a.name===b.name&&a.value===b.value?!0:!1}function E(a){var b=a._keyframeProperties,c=Q.keys(a._propertyTracks);return Q.any(b,C)&&!Q.intersection(c,T).length}function F(a,b,d){var e=[],f=a.name;"transform"===a.name&&(f=Z);var g=aa[a.nextProperty.easing.split(" ")[0]],h=V("cubic-bezier(%s)",[g]),i=c(b)?b:b.toFixed(2),j=c(d)?d:d.toFixed(2);return e.push(V("  %s% {%s:%s;%sanimation-timing-function: %s;}",[i,f,a.value,$,h])),e.push(V("  %s% {%s:%s;}",[j,f,a.nextProperty.value])),e.join("\n")}function G(a,b,c){var d=[],e=a.getEnd(),f=a.getStart(),g=a.getLength(),h=I(a,c,f);h&&d.push(h);var i=!1;Q.each(a._propertyTracks[c],function(c,e){var h,j,k,l=K(c,f,g),m=c.nextProperty;if(m){h=K(m,f,g);var n=h-l;j=Math.floor(n/100*b)||1,k=n/j}else h=100,j=1,k=1;var o;if(m&&D(c,m))o=M(a,f,c,m,l,h),i&&o.shift(),i=!1;else if(C(c)){if(o=F(c,l,h),i){var p=d.length,q=d[p-1],r=q.split("\n")[0];d[p-1]=r}i=!0}else o=L(a,j,k,f,l,c),i&&o.shift(),o.length&&(o=o.join("\n")),i=!1;o.length&&d.push(o)});var j=J(a,c,f,e);return j&&d.push(j),d.join("\n")}function H(a,b){return L(a,b+1,100/b,0,0).join("\n")}function I(a,b,c){var d=a._propertyTracks[b][0];if("undefined"!=typeof d&&d.millisecond!==c){var e=L(a,1,1,d.millisecond,0,d);return e.join("\n")}}function J(a,b,c,d){var e=Q.last(a._propertyTracks[b]);if("undefined"!=typeof e&&e.millisecond!==d){var f=L(a,1,1,c,100,e);return f.join("\n")}}function K(a,b,c){return(a.millisecond-b)/c*100}function L(a,b,c,d,e,f){var g,h,i,j=[],k=a.getLength();for(g=0;b>g;g++)h=e+g*c,a._updateState(h/100*k+d,!0),i=+h.toFixed(2)+"% ",f?j.push("  "+i+O(a,f.name)):j.push("  "+i+O(a));return j}function M(a,b,c,d,e,f){var g=L(a,1,f-e,b,e,c);return g}function N(a,b){var c=Q.pick.apply(Q,[a].concat(T));if(Q.isEmpty(c))return a;var d=Q.clone(a);return d[Z]=[],Q.each(b,function(a){Q.has(d,a)&&(d[Z].push(a+"("+d[a]+")"),delete d[a])}),d[Z]=d[Z].join(" "),d}function O(a,b){var c,d=["{"];if(b){c={};var e=a.get()[b];"undefined"!=typeof e&&(c[b]=e)}else c=a.get();var f,g=N(c,a._transformOrder);return Q.each(g,function(a,b){f=a;var c=b;"transform"===b&&(c=Z),d.push(c+":"+f+";")}),d.push("}"),d.join("")}var P=a.Rekapi,Q=P._,R=P.Tweenable.now,S=["transform","webkitTransform","MozTransform","oTransform","msTransform"],T=["translateX","translateY","translateZ","scale","scaleX","scaleY","perspective","rotate","rotateX","rotateY","rotateZ","skewX","skewY"],U=250,V=function(a,b){var c=a;return Q.each(b,function(a){c=c.replace("%s",a)}),c};P._rendererInitHook.cssAnimate=function(a){1===a.context.nodeType&&(a.renderer=new X(a))};var W=0;P.DOMRenderer=function(a){return this.rekapi=a,this._playTimestamp=null,this._cachedCSS=null,this._styleElement=null,this._stopSetTimeoutHandle=null,a.on("timelineModified",Q.bind(function(){this._cachedCSS=null},this)),a.on("addActor",k),this};var X=P.DOMRenderer;X.prototype.canAnimateWithCSS=function(){return!!d()},X.prototype.play=function(a,c){this.isPlaying()&&this.stop();var d=this._cachedCSS||this.prerender.apply(this,arguments);if(this._styleElement=e(this.rekapi,d),this._playTimestamp=R(),a){var f=a*this.rekapi.getAnimationLength();this._stopSetTimeoutHandle=setTimeout(Q.bind(this.stop,this,!0),f+U)}b(this.rekapi,"play",Q)},X.prototype.stop=function(a){if(this.isPlaying()){clearTimeout(this._stopSetTimeoutHandle),this._styleElement.innerHTML="",document.head.removeChild(this._styleElement),this._styleElement=null;var c;c=a?this.rekapi.getAnimationLength():(R()-this._playTimestamp)%this.rekapi.getAnimationLength(),this.rekapi.update(c),b(this.rekapi,"stop",Q)}},X.prototype.isPlaying=function(){return!!this._styleElement},X.prototype.prerender=function(a,b){return this._cachedCSS=this.toString({vendors:[d()],fps:b,iterations:a})},X.prototype.setActorTransformOrder=function(a,b){var c=Q.reject(b,h);if(c.length)throw"Unknown or unsupported transform functions: "+c.join(", ");return a._transformOrder=Q.uniq(b),this.rekapi},X.getActorClassName=function(a){return"actor-"+a.id},P.DOMRenderer.prototype.toString=function(a){a=a||{};var b=[];return Q.each(this.rekapi.getAllActors(),function(c){1===c.context.nodeType&&b.push(p(c,a))}),b.join("\n")};var Y=30,Z="TRANSFORM",$="VENDOR",_={microsoft:"-ms-",mozilla:"-moz-",opera:"-o-",w3:"",webkit:"-webkit-"},aa={linear:".25,.25,.75,.75",easeInQuad:".55,.085,.68,.53",easeInCubic:".55,.055,.675,.19",easeInQuart:".895,.03,.685,.22",easeInQuint:".755,.05,.855,.06",easeInSine:".47,0,.745,.715",easeInExpo:".95,.05,.795,.035",easeInCirc:".6,.04,.98, .335",easeOutQuad:".25,.46,.45,.94",easeOutCubic:".215,.61,.355,1",easeOutQuart:".165,.84,.44,1",easeOutQuint:".23,1,.32,1",easeOutSine:".39,.575,.565,1",easeOutExpo:".19,1,.22,1",easeOutCirc:".075,.82,.165,1",easeInOutQuad:".455,.03,.515,.955",easeInOutCubic:".645,.045,.355,1",easeInOutQuart:".77,0,.175,1",easeInOutQuint:".86,0.07,1",easeInOutSine:".445,.05,.55,.95",easeInOutExpo:"1,0,0,1",easeInOutCirc:".785,.135,.15,.86"},ba=["@%skeyframes %s-keyframes {","%s","}"].join("\n"),ca=[".%s {","%s","}"].join("\n")});var g=function(a,b){"use strict";var c=b?{}:a,d=b&&b.underscore?b.underscore:c._,g=b&&b.Tweenable?b.Tweenable:c.Tweenable;return f(c,d,g),d.each(e,function(a){a(c)}),c.Rekapi};if("function"==typeof define&&define.amd){var h="undefined"!=typeof _;define(["shifty","underscore"],function(a,b){var c=null!=b,d={Tweenable:a,underscore:c?b:_},e=g({},d);return!h&&c&&(this._=void 0),e})}else g(this)}("undefined"!=typeof window?window:"undefined"==typeof global?this:global);